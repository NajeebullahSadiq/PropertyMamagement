<!-- Loading Indicator -->
<div *ngIf="isLoading" class="loading-container">
  <div class="loading-spinner"></div>
  <p>در حال بارگذاری معلومات جواز...</p>
</div>

<div class="certificate-page" *ngIf="!isLoading">
  <div class="certificate-wrapper">
    <!-- Decorative Blue Border Frame -->
    <div class="decorative-border">
      <!-- Corner Decorations -->
      <div class="corner-decoration top-right"></div>
      <div class="corner-decoration top-left"></div>
      <div class="corner-decoration bottom-right"></div>
      <div class="corner-decoration bottom-left"></div>
      
      <div class="certificate-content">
        <!-- Header Section - 3 Columns -->
        <table class="header-table">
          <tr>
            <!-- RIGHT side: National Emblem + License Info -->
            <td class="header-col-right">
              <img src="/assets/img/afg.png" alt="نشان ملی افغانستان" class="national-emblem">
              <p class="license-info">شماره جوازنامه <span>({{data.licenseNumber || '     '}})</span></p>
              <p class="license-info">تاریخ صدور: <span>{{data.issueDateFormatted || (data.issueDate | calendarDate) || '     '}}</span></p>
              <p class="license-info">تاریخ ختم: <span>{{data.expireDateFormatted || (data.expireDate | calendarDate) || '     '}}</span></p>
            </td>
            <!-- CENTER: Ministry Info -->
            <td class="header-col-center">
              <p class="ministry-line-1">امارت اسلامی افغانستان</p>
              <p class="ministry-line-2">وزارت عدلیه</p>
              <p class="ministry-line-3">ریاست عمومی انسجام</p>
              <p class="ministry-line-4">ریاست امور رهنمای معاملات و عریضه نویسان</p>
            </td>
            <!-- LEFT side: Ministry Logo + Photo (stacked vertically) -->
            <td class="header-col-left">
              <div class="left-column-content">
                <img src="/assets/img/mcitlogo.png" alt="لوگو وزارت" class="ministry-logo">
                <div class="photo-frame">
                  <img [src]="filePath" alt="عکس" class="owner-photo" onerror="this.src='assets/img/avatar2.png'">
                </div>
              </div>
            </td>
          </tr>
        </table>

        <!-- Title Section -->
        <div class="title-section">
          <p class="certificate-title">جوازنامه فعالیت رهنمای معاملات <span>({{data.title || '     '}})</span></p>
        </div>

        <!-- Main Content -->
        <div class="main-content">
          <!-- Line 1 -->
          <p class="info-line">
            محترم <span class="val">({{data.firstName || '     '}})</span>
            ولد <span class="val">({{data.fatherName || '     '}})</span>
            ولدیت <span class="val">({{data.grandFatherName || '     '}})</span>
            متولد سال <span class="val">({{data.dateOfBirthFormatted || (data.dateofBirth | calendarDate) || '     '}})</span>
           دارنده تذکره الکټرونیکی ()
          </p>

          <!-- Line 2 -->
          <p class="info-line">
            <span class="red">مسکونه اصلی ولسوالی</span> <span class="val">({{data.permanentDistrictName || '     '}})</span>
            <span class="red">ولایت</span> <span class="val">({{data.permanentProvinceName || '     '}})</span>
            <span class="red">مسکونه فعلی ناحیه یا ولسوالی</span> <span class="val">({{data.temporaryDistrictName || '     '}})</span>
            <span class="red">ولایت</span> <span class="val">({{data.temporaryProvinceName || '     '}})</span>
          </p>

          <!-- Authorization Line -->
          <p class="info-line">
            <span class="red">واقع ناحیه</span> <span class="val">({{data.temporaryVillage || data.permanentVillage || '     '}})</span>
            با در نظرداشت احکام مندرج فقره (4) ماده (13) قانون رهنمای معاملات این جوازنامه اعطاء و به اساس آن موصوف میتواند در حدود احکام قانون در عقود و معاملات بین اشخاص وساطت نماید.
          </p>

          <!-- Inquiry Line -->
          <p class="info-line small">
            ذریعه استعلام نمبر <span class="val underline">(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span> به مطبعه معرفی شد.
          </p>

          <!-- Signature -->
          <div class="signature-block">
            <p>بااحترام</p>
            <p class="sig-title">رئیس عمومی انسجام</p>
          </div>
        </div>

        <!-- Footer Section -->
        <div class="footer-section">
          <p class="footer-line">آدرس دفتر رهنمای معاملات: <span class="val">({{data.officeAddress || '     '}})</span></p>
          
          <p class="note-line"><span class="note-label">نوت:</span> مدت اعتبار این جوازنامه از تاریخ صدور برای مدت سه سال می باشد.</p>
          
          <p class="footer-line">
            شماره تماس دارنده جوازنامه: <span class="val">({{data.phoneNumber || '     '}})</span>
            نمبر تشخیصیه <span class="val">({{data.tin || '     '}})</span>
            شماره ثبت <span class="val underline">(     )</span>
            دیتابیس
            قیمت جواز نامه: <span class="val">(پانزده هزار افغانی)</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
