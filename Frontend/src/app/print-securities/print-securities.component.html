<div class="print-container" *ngIf="!isLoading && item">
  <!-- Header -->
  <div class="print-header">
    <div class="header-logo">
      <img src="assets/img/afg.png" alt="نشان ملی افغانستان" class="logo">
    </div>
    <div class="header-title">
      <h1>امارت اسلامی افغانستان</h1>
      <h2>وزارت عدلیه</h2>
      <h3>معینیت مالی و اداری</h3>
      <h4>ریاست عمومی انسجام</h4>
      <h5>ریاست امور رهنمای معاملات و عریضه نویسان</h5>
      <h6>مدیریت عمومی توزیع اسناد بهادار</h6>
      <h6>مدیریت توزیع سته ها و کتاب ثبت</h6>
    </div>
    <div class="header-logo">
      <img src="assets/img/mcitlogo.png" alt="Ministry Logo" class="logo">
    </div>
  </div>
  
  <div class="header-info">
    <p>نمبر ثبت: {{ item.registrationNumber }}</p>
    <p>تاریخ توزیع: {{ item.distributionDateFormatted || '-' }}</p>
  </div>

  <!-- Section 1: مشخصات رهنمای معاملات -->
  <div class="print-section">
    <h4 class="section-title">مشخصات رهنمای معاملات</h4>
    <table class="info-table">
      <tr>
        <td class="label">نمبر ثبت:</td>
        <td class="value">{{ item.registrationNumber }}</td>
        <td class="label">نمبر جواز:</td>
        <td class="value">{{ item.licenseNumber }}</td>
      </tr>
      <tr>
        <td class="label">اسم صاحب امتیاز جواز:</td>
        <td class="value">{{ item.licenseOwnerName }}</td>
        <td class="label">اسم پدر:</td>
        <td class="value">{{ item.licenseOwnerFatherName }}</td>
      </tr>
      <tr>
        <td class="label">نام رهنمای معاملات:</td>
        <td class="value" colspan="3">{{ item.transactionGuideName }}</td>
      </tr>
    </table>
  </div>

  <!-- Section 2: مشخصات اسناد توزیعی -->
  <div class="print-section">
    <h4 class="section-title">مشخصات اسناد توزیعی</h4>
    <table class="info-table">
      <ng-container *ngFor="let docItem of item.items">
        <tr>
          <td class="label">نوعیت اسناد:</td>
          <td class="value">{{ getDocumentTypeName(docItem.documentType) }}</td>
          <td class="label">تعداد:</td>
          <td class="value">{{ docItem.count || '-' }}</td>
        </tr>
        <tr *ngIf="docItem.serialStart && docItem.serialEnd">
          <td class="label">سریال نمبر:</td>
          <td class="value" colspan="3">{{ docItem.serialStart }} الی {{ docItem.serialEnd }}</td>
        </tr>
      </ng-container>
      
      <tr>
        <td class="label">مجموع اسناد:</td>
        <td class="value total" colspan="3">{{ getTotalDocumentCount() }} جلد</td>
      </tr>
    </table>
  </div>

  <!-- Section 3: قیمت اسناد بهادار -->
  <div class="print-section">
    <h4 class="section-title">قیمت اسناد بهادار</h4>
    <table class="info-table">
      <ng-container *ngFor="let docItem of item.items">
        <tr>
          <td class="label">{{ getDocumentTypeName(docItem.documentType) }}:</td>
          <td class="value">{{ docItem.count }} × {{ getPricePerUnit(docItem.documentType) | number }} افغانی</td>
          <td class="label">مجموع:</td>
          <td class="value">{{ docItem.price | number }} افغانی</td>
        </tr>
      </ng-container>
      <tr>
        <td class="label" colspan="2">قیمت مجموعی اسناد:</td>
        <td class="value total" colspan="2">{{ getTotalPrice() | number }} افغانی</td>
      </tr>
    </table>
  </div>

  <!-- Section 4: آویز و تاریخ -->
  <div class="print-section">
    <h4 class="section-title">مشخصات آویز تحویلی و تاریخ توزیع</h4>
    <table class="info-table">
      <tr>
        <td class="label">آویز نمبر بانکی:</td>
        <td class="value">{{ item.bankReceiptNumber || '-' }}</td>
        <td class="label">تاریخ تحویلی:</td>
        <td class="value">{{ item.deliveryDateFormatted || '-' }}</td>
      </tr>
      <tr>
        <td class="label">تاریخ توزیع:</td>
        <td class="value" colspan="3">{{ item.distributionDateFormatted || '-' }}</td>
      </tr>
    </table>
  </div>

  <!-- Signatures -->
  <div class="signatures">
    
    <div class="signature-box">
      <p>امضای مدیر توزیع سټه ها وکتاب ثبت</p>
      <div class="signature-line"></div>
    </div>
    <div class="signature-box">
      <p>امضای تسلیم شونده</p>
      <div class="signature-line"></div>
    </div>
  </div>

  <!-- Footer -->
  <div class="print-footer">
    <p>این سند رسمی بوده و جعل آن جرم پنداشته می‌شود</p>
  </div>
</div>

<div *ngIf="isLoading" class="loading">
  <p>در حال بارگذاری...</p>
</div>
