<div class="document-viewer-container">
  <div class="viewer-header">
    <h2>{{ fileName }}</h2>
    <button class="close-btn" (click)="closeDialog()" title="بستن">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <div class="viewer-content">
    <div *ngIf="isLoading" class="loading-spinner">
      <div class="spinner"></div>
      <p>در حال بارگذاری...</p>
    </div>

    <div *ngIf="error && !isLoading" class="error-message">
      <i class="fas fa-exclamation-circle"></i>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="downloadFile()">
        <i class="fas fa-download"></i> دانلود فایل
      </button>
    </div>

    <div *ngIf="isImage && imageUrl && !isLoading" class="flex items-center justify-center w-full h-full min-h-96">
      <img [src]="imageUrl" alt="{{ fileName }}" class="max-w-full max-h-full min-h-48 object-contain rounded shadow-lg bg-white" (error)="onImageError()" (load)="onImageLoad()">
    </div>

    <div *ngIf="isPdf && pdfUrl && !isLoading" class="w-full h-full flex flex-col">
      <div class="mb-2 text-center">
        <a [href]="pdfUrl" target="_blank" class="inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
          <i class="fas fa-external-link-alt ml-2"></i>
          باز کردن PDF در تب جدید
        </a>
      </div>
      <iframe [src]="pdfUrl" class="flex-1 w-full border-0 rounded min-h-96" sandbox="allow-same-origin allow-scripts allow-popups" allowfullscreen (load)="onPdfLoad()" (error)="onPdfError()" frameborder="0"></iframe>
    </div>
  </div>

  <div class="viewer-footer">
    <button class="btn btn-secondary" (click)="closeDialog()">بستن</button>
    <button class="btn btn-primary" (click)="downloadFile()">
      <i class="fas fa-download"></i> دانلود
    </button>
  </div>
</div>
