<div class="flex flex-col h-full max-h-[90vh] bg-gray-50 rounded-lg overflow-hidden">
  <!-- Header -->
  <div class="flex justify-between items-center px-6 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white">
    <h2 class="text-lg font-semibold truncate flex-1">{{ fileName }}</h2>
    <button 
      (click)="closeDialog()" 
      class="w-10 h-10 flex items-center justify-center rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition-all ml-3"
      title="بستن"
    >
      <i class="fas fa-times text-lg"></i>
    </button>
  </div>

  <!-- Content Area -->
  <div class="flex-1 overflow-auto flex items-center justify-center p-6 bg-white">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex flex-col items-center justify-center gap-4">
      <div class="w-12 h-12 border-4 border-gray-200 border-t-purple-600 rounded-full animate-spin"></div>
      <p class="text-gray-600 text-base">در حال بارگذاری...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="flex flex-col items-center justify-center gap-4 p-8 text-center">
      <i class="fas fa-exclamation-circle text-5xl text-red-500"></i>
      <p class="text-gray-700 text-base">{{ error }}</p>
      <button 
        (click)="downloadFile()" 
        class="inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
      >
        <i class="fas fa-download"></i>
        <span>دانلود فایل</span>
      </button>
    </div>

    <!-- Image Display -->
    <div *ngIf="!isLoading && !error && isImage" class="w-full h-full flex items-center justify-center min-h-[400px]">
      <img 
        [src]="imageUrl" 
        [alt]="fileName" 
        (load)="onImageLoad()" 
        (error)="onImageError($event)"
        class="max-w-full max-h-[70vh] w-auto h-auto object-contain rounded-lg shadow-xl bg-white"
      />
    </div>

    <!-- PDF Display -->
    <div *ngIf="!isLoading && !error && isPdf" class="w-full h-full flex flex-col min-h-[500px]">
      <div class="flex justify-center p-3 bg-gray-100 rounded-lg mb-3">
        <a 
          [href]="rawFileUrl" 
          target="_blank" 
          class="inline-flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 hover:shadow-lg transition-all text-sm"
        >
          <i class="fas fa-external-link-alt text-xs"></i>
          <span>باز کردن در تب جدید</span>
        </a>
      </div>
      <iframe 
        [src]="fileUrl" 
        (load)="onPdfLoad()" 
        (error)="onPdfError($event)"
        class="flex-1 w-full min-h-[500px] border-0 rounded-lg bg-white shadow-lg"
        frameborder="0"
      ></iframe>
    </div>

    <!-- Unsupported File Type -->
    <div *ngIf="!isLoading && !error && !isImage && !isPdf" class="flex flex-col items-center justify-center gap-4 p-8 text-center">
      <i class="fas fa-file text-5xl text-gray-400"></i>
      <p class="text-gray-700 text-base">نوع فایل پشتیبانی نشده است</p>
      <button 
        (click)="downloadFile()" 
        class="inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
      >
        <i class="fas fa-download"></i>
        <span>دانلود فایل</span>
      </button>
    </div>
  </div>

  <!-- Footer -->
  <div class="flex justify-end gap-3 px-6 py-4 bg-gray-100 border-t border-gray-200">
    <button 
      (click)="closeDialog()" 
      class="inline-flex items-center gap-2 px-5 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium"
    >
      <i class="fas fa-times"></i>
      <span>بستن</span>
    </button>
    <button 
      (click)="downloadFile()" 
      class="inline-flex items-center gap-2 px-5 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium"
    >
      <i class="fas fa-download"></i>
      <span>دانلود</span>
    </button>
  </div>
</div>
