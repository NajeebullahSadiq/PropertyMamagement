<section class="w-full bg-gray-50 py-6">
  <div class="max-w-5xl mx-auto px-4">
    <div class="mb-6">
      <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">
        {{ isEditMode ? 'ویرایش' : 'ثبت' }} سند بهادار عریضه‌ نویسان
      </h1>
      <p class="text-center text-gray-600">لطفاً تمام معلومات را با دقت تکمیل نمایید</p>
    </div>

    <form [formGroup]="petitionForm" (ngSubmit)="onSubmit()">
      <mat-tab-group [(selectedIndex)]="selectedTabIndex" class="petition-tabs">
        <!-- Tab 1: مشخصات عریضه‌نویس -->
        <mat-tab>
          <ng-template matTabLabel>
            <mat-icon class="ml-2">person</mat-icon>
            مشخصات عریضه‌نویس
          </ng-template>
          
          <div class="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden mt-4">
            <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4">
              <h2 class="text-xl font-bold text-white flex items-center gap-2">
                <i class="fas fa-user"></i>
                <span>مشخصات عریضه‌نویس</span>
              </h2>
            </div>
            <div class="px-6 py-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- نمبر ثبت تعرفه -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    نمبر ثبت تعرفه <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="registrationNumber"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="نمبر ثبت تعرفه را وارد کنید">
                  <div *ngIf="registrationNumber?.invalid && registrationNumber?.touched">
                    <small class="text-red-600 text-xs" *ngIf="registrationNumber?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- اسم عریضه‌نویس -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    اسم عریضه‌نویس <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="petitionWriterName"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="اسم عریضه‌نویس را وارد کنید">
                  <div *ngIf="petitionWriterName?.invalid && petitionWriterName?.touched">
                    <small class="text-red-600 text-xs" *ngIf="petitionWriterName?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- اسم پدر عریضه‌نویس -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    اسم پدر عریضه‌نویس <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="petitionWriterFatherName"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="اسم پدر عریضه‌نویس را وارد کنید">
                  <div *ngIf="petitionWriterFatherName?.invalid && petitionWriterFatherName?.touched">
                    <small class="text-red-600 text-xs" *ngIf="petitionWriterFatherName?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- نمبر جواز عریضه‌نویس -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    نمبر جواز عریضه‌نویس <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="licenseNumber"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    placeholder="نمبر جواز عریضه‌نویس را وارد کنید">
                  <div *ngIf="licenseNumber?.invalid && licenseNumber?.touched">
                    <small class="text-red-600 text-xs" *ngIf="licenseNumber?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="flex justify-end mt-4">
            <button type="button" (click)="nextTab()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
              بعدی <mat-icon class="align-middle">arrow_back</mat-icon>
            </button>
          </div>
        </mat-tab>

        <!-- Tab 2: مشخصات سند بهادار عریضه -->
        <mat-tab>
          <ng-template matTabLabel>
            <mat-icon class="ml-2">description</mat-icon>
            مشخصات سند بهادار عریضه
          </ng-template>
          
          <div class="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden mt-4">
            <div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4">
              <h2 class="text-xl font-bold text-white flex items-center gap-2">
                <i class="fas fa-file-alt"></i>
                <span>مشخصات سند بهادار عریضه</span>
              </h2>
            </div>
            <div class="px-6 py-6">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- تعداد عریضه -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    تعداد عریضه <span class="text-red-500">*</span>
                  </label>
                  <input type="text" appNumericInput formControlName="petitionCount"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="تعداد عریضه را وارد کنید">
                  <div *ngIf="petitionCount?.invalid && petitionCount?.touched">
                    <small class="text-red-600 text-xs" *ngIf="petitionCount?.errors?.['required']">این فیلد الزامی است</small>
                    <small class="text-red-600 text-xs" *ngIf="petitionCount?.errors?.['min']">تعداد باید بزرگتر از صفر باشد</small>
                  </div>
                </div>

                <!-- مبلغ پول -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    مبلغ پول <span class="text-red-500">*</span>
                  </label>
                  <input type="text" appNumericInput [allowDecimal]="true" formControlName="amount"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="مبلغ پول را وارد کنید">
                  <div *ngIf="amount?.invalid && amount?.touched">
                    <small class="text-red-600 text-xs" *ngIf="amount?.errors?.['required']">این فیلد الزامی است</small>
                    <small class="text-red-600 text-xs" *ngIf="amount?.errors?.['min']">مبلغ باید عدد مثبت باشد</small>
                  </div>
                </div>

                <!-- آویز نمبر بانکی -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    آویز نمبر بانکی <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="bankReceiptNumber"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="آویز نمبر بانکی را وارد کنید">
                  <div *ngIf="bankReceiptNumber?.invalid && bankReceiptNumber?.touched">
                    <small class="text-red-600 text-xs" *ngIf="bankReceiptNumber?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- آغاز سریال نمبر عریضه -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    آغاز سریال نمبر عریضه <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="serialNumberStart"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="آغاز سریال نمبر عریضه را وارد کنید">
                  <div *ngIf="serialNumberStart?.invalid && serialNumberStart?.touched">
                    <small class="text-red-600 text-xs" *ngIf="serialNumberStart?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- ختم سریال نمبر عریضه -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    ختم سریال نمبر عریضه <span class="text-red-500">*</span>
                  </label>
                  <input type="text" formControlName="serialNumberEnd"
                    class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="ختم سریال نمبر عریضه را وارد کنید">
                  <div *ngIf="serialNumberEnd?.invalid && serialNumberEnd?.touched">
                    <small class="text-red-600 text-xs" *ngIf="serialNumberEnd?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>

                <!-- تاریخ توزیع عریضه -->
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">
                    تاریخ توزیع عریضه <span class="text-red-500">*</span>
                  </label>
                  <div class="input-group">
                    <input class="form-control w-full px-4 py-2.5 border border-gray-300 rounded-lg"
                      placeholder="yyyy-mm-dd" name="distributionDate" formControlName="distributionDate"
                      ngbDatepicker #distributionDatePicker="ngbDatepicker" [minDate]="minDate" [maxDate]="maxDate">
                    <button class="btn btn-outline-secondary calendar-btn" (click)="distributionDatePicker.toggle()" type="button">
                      <i class="fa fa-calendar"></i>
                    </button>
                  </div>
                  <div *ngIf="distributionDate?.invalid && distributionDate?.touched">
                    <small class="text-red-600 text-xs" *ngIf="distributionDate?.errors?.['required']">این فیلد الزامی است</small>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="flex justify-between mt-4">
            <button type="button" (click)="prevTab()" class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
              <mat-icon class="align-middle">arrow_forward</mat-icon> قبلی
            </button>
            <div class="flex gap-2">
              <button type="button" (click)="goToList()" class="px-6 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500">
                انصراف
              </button>
              <button type="button" (click)="resetForm()" class="px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">
                پاک کردن
              </button>
              <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                <mat-icon class="align-middle">save</mat-icon>
                {{ isEditMode ? 'بروزرسانی' : 'ثبت' }}
              </button>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </form>
  </div>
</section>
