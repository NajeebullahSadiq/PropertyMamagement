<mat-toolbar class="toolbar-modern !h-14 !px-4">
  <!-- Gradient background -->
  <div class="toolbar-bg"></div>
  
  <button
    mat-icon-button
    *ngIf="sidenav.mode === 'over'"
    (click)="sidenav.toggle()"
    class="relative z-10 text-white hover:bg-white/10"
  >
    <mat-icon *ngIf="!sidenav.opened">menu</mat-icon>
    <mat-icon *ngIf="sidenav.opened">close</mat-icon>
  </button>

  <div class="relative z-10 flex items-center gap-3">
    <img src="assets/img/mcitlogo.png" class="h-9 w-9 object-contain" />
    <div class="flex flex-col">
      <span class="text-[10px] text-white/70">{{ "title2" | translate }}</span>
      <span class="text-sm font-bold text-white">{{ "title1" | translate }}</span>
    </div>
  </div>

  <span class="flex-1"></span>

  <div class="relative z-10 flex items-center gap-1">
    <app-calendar-selector></app-calendar-selector>

    <button mat-icon-button [matMenuTriggerFor]="userAccountMenu" class="text-white hover:bg-white/10">
      <mat-icon>account_circle</mat-icon>
    </button>

    <mat-menu #userAccountMenu>
      <button mat-menu-item routerLink="/dashboard/Auth/Register" *ngIf="userRole == 'ADMIN'">
        <mat-icon>people</mat-icon>
        <span class="font-bold">ایجاد کاربر</span>
      </button>
      <button mat-menu-item (click)="openDialog()">
        <mat-icon>lock</mat-icon>
        <span class="font-bold">تغیر پسورد</span>
      </button>
      <button mat-menu-item (click)="openReset()" *ngIf="userRole == 'ADMIN'">
        <mat-icon>lock_reset</mat-icon>
        <span class="font-bold">باز نشانی پسورد</span>
      </button>
      <button mat-menu-item (click)="openLockuser()" *ngIf="userRole == 'ADMIN'">
        <mat-icon>lock_person</mat-icon>
        <span class="font-bold">قفل حساب کابران</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="onLogout()">
        <mat-icon class="text-red-500">logout</mat-icon>
        <span class="font-bold text-red-600">خروج</span>
      </button>
    </mat-menu>

    <button mat-icon-button [matMenuTriggerFor]="lang" class="text-white hover:bg-white/10">
      <mat-icon>translate</mat-icon>
    </button>

    <mat-menu #lang>
      <button mat-menu-item (click)="setlang()">
        <span class="font-bold">دری</span>
      </button>
      <button mat-menu-item (click)="setlangen()">
        <span class="font-bold">پشتو</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav #sidenav="matSidenav" class="sidenav-modern">
    <!-- User Profile - Compact -->
    <div class="p-3 border-b border-slate-200 text-center">
      <img
        class="mx-auto h-12 w-12 rounded-full object-cover border-2 border-slate-200"
        [src]="filePath"
        (error)="handleImageError()"
      />
      <div class="mt-2 text-sm font-bold text-slate-800">
        {{ userDetails.firstName }} {{ userDetails.lastName }}
      </div>
      <div class="text-xs text-slate-500 font-semibold">
        {{ userRole == 'ADMIN' ? 'مدیر سیستم' : 'کاربر' }}
      </div>
    </div>

    <!-- Navigation - Compact -->
    <nav class="p-2">
      <!-- Dashboard -->
      <a *ngIf="userRole == 'ADMIN'" routerLink="/dashboard/dashboard" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>dashboard</mat-icon>
        <span>{{ "dashboard" | translate }}</span>
      </a>

      <!-- Company Section -->
      <div *ngIf="userRole == 'ADMIN'" class="section-label">شرکت ها</div>

      <a *ngIf="userRole == 'ADMIN'" routerLink="/dashboard/realestate" routerLinkActive="active-nav" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
        <mat-icon>business</mat-icon>
        <span>{{ "company" | translate }}</span>
      </a>

      <a *ngIf="userRole == 'ADMIN'" routerLink="/dashboard/realestate/list" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>list_alt</mat-icon>
        <span>{{ "companylist" | translate }}</span>
      </a>

      <!-- Property Section -->
      <div class="section-label">ملکیت ها</div>

      <a routerLink="/dashboard/estate" routerLinkActive="active-nav" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
        <mat-icon>apartment</mat-icon>
        <span>{{ "property" | translate }}</span>
      </a>

      <a routerLink="/dashboard/estate/list" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>format_list_bulleted</mat-icon>
        <span>{{ "propertylist" | translate }}</span>
      </a>

      <!-- Vehicle Section -->
      <div class="section-label">وسایط نقلیه</div>

      <a routerLink="/dashboard/vehicle" routerLinkActive="active-nav" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
        <mat-icon>directions_car</mat-icon>
        <span>{{ "vehicle" | translate }}</span>
      </a>

      <a routerLink="/dashboard/vehicle/list" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>format_list_bulleted</mat-icon>
        <span>{{ "vehiclelist" | translate }}</span>
      </a>

      <!-- Reports Section -->
      <div *ngIf="userRole == 'ADMIN'" class="section-label">گزارشات</div>

      <a *ngIf="userRole == 'ADMIN'" routerLink="/dashboard/report" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>assessment</mat-icon>
        <span>{{ "report" | translate }}</span>
      </a>

      <a *ngIf="userRole == 'ADMIN'" routerLink="/dashboard/userreport" routerLinkActive="active-nav" class="nav-link">
        <mat-icon>summarize</mat-icon>
        <span>{{ "reportbycompany" | translate }}</span>
      </a>
    </nav>
  </mat-sidenav>

  <mat-sidenav-content class="bg-slate-50">
    <div class="m-4 rounded-xl bg-white shadow-sm border border-slate-200 min-h-[calc(100vh-88px)]">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
