<mat-toolbar class="mat-elevation-z1 !px-4 !h-16 relative overflow-hidden border-b border-white/10 bg-white/10 text-white backdrop-blur-xl">
  <div class="pointer-events-none absolute inset-0 bg-gradient-to-r from-slate-950/70 via-indigo-950/50 to-fuchsia-950/60"></div>
  <div class="pointer-events-none absolute -top-20 -left-24 h-56 w-56 rounded-full bg-fuchsia-500/25 blur-3xl"></div>
  <div class="pointer-events-none absolute -bottom-24 left-1/3 h-64 w-64 rounded-full bg-cyan-400/20 blur-3xl"></div>
  <div class="pointer-events-none absolute inset-0 ring-1 ring-inset ring-white/10"></div>

  <button
    mat-icon-button
    class="relative rounded-lg transition-colors hover:bg-white/10"
    *ngIf="sidenav.mode === 'over'"
    (click)="sidenav.toggle()"
  >
    <mat-icon *ngIf="!sidenav.opened">menu</mat-icon>
    <mat-icon *ngIf="sidenav.opened">close</mat-icon>
  </button>

  <div class="relative flex items-center gap-3">
    <img src="assets/img/mcitlogo.png" class="h-10 w-10 object-contain drop-shadow" />
    <div class="flex flex-col leading-tight">
      <div class="text-[11px] font-medium text-white/70">{{'title2' | translate}}</div>
      <div class="text-sm font-semibold text-white">{{'title1' | translate}}</div>
    </div>
  </div>

  <span class="flex-1"></span>

  <div class="relative flex items-center gap-1 sm:gap-2">
    <app-calendar-selector></app-calendar-selector>

    <button
      mat-icon-button
      matTooltip="My Account"
      [matMenuTriggerFor]="userAccountMenu"
      class="rounded-lg transition-colors hover:bg-white/10"
    >
      <mat-icon>account_circle</mat-icon>
    </button>

    <mat-menu #userAccountMenu [overlapTrigger]="false" yPosition="below">
      <button mat-menu-item routerLink="/dashboard/Auth/Register" *ngIf="userRole=='ADMIN'">
        <mat-icon>people</mat-icon>
        <span class="text-sm font-semibold">ایجاد کاربر</span>
      </button>
      <button mat-menu-item (click)="openDialog()">
        <mat-icon class="changepassword-icon">lock</mat-icon>
        <span class="text-sm font-semibold">تغیر پسورد</span>
      </button>
      <button mat-menu-item (click)="openReset()" *ngIf="userRole=='ADMIN'">
        <mat-icon class="changepassword-icon">lock</mat-icon>
        <span class="text-sm font-semibold">باز نشانی پسورد</span>
      </button>
      <button mat-menu-item (click)="openLockuser()" *ngIf="userRole=='ADMIN'">
        <mat-icon class="changepassword-icon">lock</mat-icon>
        <span class="text-sm font-semibold">قفل حساب کابران</span>
      </button>
      <button mat-menu-item (click)="onLogout()">
        <mat-icon>exit_to_app</mat-icon>
        <span class="text-sm font-semibold"> خروج </span>
      </button>
    </mat-menu>

    <button
      mat-icon-button
      matTooltip="Languages"
      [matMenuTriggerFor]="lang"
      class="rounded-lg transition-colors hover:bg-white/10"
    >
      <mat-icon>language</mat-icon>
    </button>

    <mat-menu #lang [overlapTrigger]="false" yPosition="below">
      <button mat-menu-item (click)="setlang()">
        <mat-icon>flag</mat-icon>
        <span class="text-sm font-semibold">دری</span>
      </button>
      <button mat-menu-item (click)="setlangen()">
        <mat-icon>flag</mat-icon>
        <span class="text-sm font-semibold">پشتو</span>
      </button>
    </mat-menu>
  </div>
</mat-toolbar>

<mat-sidenav-container class="h-[calc(100vh-64px)] bg-slate-50">
  <mat-sidenav
    #sidenav="matSidenav"
    class="m-4 w-[296px] rounded-2xl bg-white text-slate-900 shadow-sm ring-1 ring-slate-200 overflow-y-auto"
  >
    <div class="px-4 pt-5 pb-4 text-center">
      <img
        class="mx-auto h-20 w-20 rounded-full object-cover ring-2 ring-slate-200 shadow-sm"
        [src]="filePath"
        (error)="handleImageError()"
      />
      <div class="mt-3 text-sm font-semibold leading-6 text-slate-800 break-words">
        {{userDetails.firstName}} {{userDetails.lastName}}
      </div>
    </div>

    <div class="h-px bg-slate-200 mx-3"></div>

    <nav class="sidebar-nav mt-3 flex flex-col gap-1 px-2 pb-4">
      <div *ngIf="userRole=='ADMIN'">
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/dashboard"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'dashboard' | translate}}</span>
            <mat-icon class="shrink-0 !text-[20px]">home</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/estate"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'property' | translate}}</span>
            <mat-icon class="mat-icon-notranslate shrink-0 !text-[20px]">apartment</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/estate/list"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'propertylist' | translate}}</span>
            <mat-icon class="bill-icon shrink-0 !text-[20px]">receipt</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/vehicle"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'vehicle' | translate}}</span>
            <mat-icon class="mat-icon-notranslate shrink-0 !text-[20px]">directions_car</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/vehicle/list"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'vehiclelist' | translate}}</span>
            <mat-icon class="bill-icon shrink-0 !text-[20px]">receipt</mat-icon>
          </div>
        </button>
      </div>

      <div *ngIf="userRole=='ADMIN'">
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/realestate"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'company' | translate}}</span>
            <mat-icon class="shrink-0 !text-[20px]">business</mat-icon>
          </div>
        </button>
      </div>

      <div *ngIf="userRole=='ADMIN'">
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/realestate/list"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'companylist' | translate}}</span>
            <mat-icon class="mat-icon-notranslate shrink-0 !text-[20px]">description</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/report"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
          *ngIf="userRole=='ADMIN'"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'report' | translate}}</span>
            <mat-icon class="shrink-0 !text-[20px]">insert_chart</mat-icon>
          </div>
        </button>
      </div>

      <div>
        <button
          mat-button
          class="group w-full rounded-xl !px-3 !py-2.5 text-sm font-semibold text-slate-700 transition-colors hover:bg-slate-100 hover:text-slate-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-200"
          routerLink="/dashboard/userreport"
          routerLinkActive="bg-blue-50 text-blue-900 ring-1 ring-inset ring-blue-200"
          *ngIf="userRole=='ADMIN'"
        >
          <div dir="ltr" class="w-full flex items-center justify-between gap-3">
            <span dir="rtl" class="flex-1 text-right text-2xl font-extrabold">{{'reportbycompany' | translate}}</span>
            <mat-icon class="shrink-0 !text-[20px]">insert_chart</mat-icon>
          </div>
        </button>
      </div>
    </nav>
  </mat-sidenav>

  <mat-sidenav-content class="flex flex-col">
    <div class="m-4 flex-1 rounded-2xl bg-white shadow-sm ring-1 ring-slate-200">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>